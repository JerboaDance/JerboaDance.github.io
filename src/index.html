<html>
  <head>
    <meta http-equiv='content-language' content='en-US'>
    <link rel="icon" type="image/png" href="/assets/logos/logo-white.png" />
    <link rel="stylesheet" href="/css/main.css"/>
    <title>Jerboa Dance - Home</title>
    <script src="/scripts/common.js" type="module"></script>
    <script type="module">
      import { 
        findNextUpcomingShow,
        generateLink,
        populateHeaderImage,
        populateVenue,
        populateBrownPaperTicketsWidget,
        populateTicketTiers,
        populateShowtimes,
        populateCastList,
      } from "/scripts/shows.js";
      import { generateYouTubeEmbed } from "/scripts/youTube.js"
      
      function populateUpcomingPerformance(show) {
        const upcomingPerformance = show.performances[0];
        const { dates, venue, bptId, ticketTiers, showtimes, emcee, highlights, companyMembers } = upcomingPerformance;

        const headerImage = document.getElementById("headerImage");
        populateHeaderImage(headerImage, show);
        
        const bptElement = document.getElementById("upcomingBptWidget");
        populateBrownPaperTicketsWidget(bptElement, bptId);

        const nameElement = document.getElementById("name");
        nameElement.innerText = show.name;

        const datesElement = document.getElementById("upcomingDates");
        datesElement.innerText = dates;

        const venueElement = document.getElementById("upcomingVenue");
        populateVenue(venueElement, venue);

        const descriptionElement = document.getElementById("upcomingDescription");
        descriptionElement.innerHTML = show.description;

        const ticketTierListElement = document.getElementById("upcomingTicketTiers");
        populateTicketTiers(ticketTierListElement, ticketTiers);

        const showtimesListElement = document.getElementById("upcomingShowtimes")
        populateShowtimes(showtimesListElement, showtimes);

        const castListElement = document.getElementById("upcomingCastList");
        populateCastList(castListElement, emcee, highlights, companyMembers);
      }

      function populatePage() {
        const mainElement = document.getElementById("main");
        
        const nextUpcomingShow = findNextUpcomingShow();
        if (nextUpcomingShow) {
          populateUpcomingPerformance(nextUpcomingShow);
        } else {
          const upcomingPerformanceElement = document.getElementById("upcomingPerformance");
          upcomingPerformanceElement.hidden = true;
          
          const headerImage = document.getElementById("headerImage");
          headerImage.setAttribute("src", `/assets/defaultIndexHeader.jpg`);
        }
        
        const teaserVideo = document.createElement("div")
        teaserVideo.setAttribute("class", "teaser-video");
        teaserVideo.append(generateYouTubeEmbed({ id: "GSR_h1AcrU8", aspectRatio:"16x9"}));
        mainElement.append(teaserVideo);
      }
      populatePage();
    </script>
  </head>
  <body>
    <div class="bodyWrapper">
      <header id="header"></header>
      <div class="header-image"><img id="headerImage" /></div>
      <main id="main">
        <div id="upcomingPerformance">
          <div id="upcomingBptWidget" class="tickets"></div>
          <h1 id="name"></h1>
          <h2 id="upcomingDates" class="show-dates"></h2>
          <h3 class="venue"><a id="upcomingVenue"></a></h3>
          <p id="upcomingDescription"></p>
          <ul id="upcomingTicketTiers" class="ticket-tiers"></ul>
          <ul id="upcomingShowtimes" class="show-times"></ul>
          <ul id="upcomingCastList" class="cast-list"></ul>
        </div>
      </main>
      <footer id="footer"></footer>
    </div>
  </body>
</html>